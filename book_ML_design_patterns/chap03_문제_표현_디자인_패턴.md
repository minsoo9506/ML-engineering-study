# 3 문제 표현 디자인 패턴

## 3.1 디자인 패턴 5: reframing

- 머신러닝에서의 문제에서 output feature를 바꾸는 방식
  - 예를 들어, 회귀문제를 분류문제로 바꿔서 진행

### 3.1.1 문제

- 머신러닝에서 가장 먼저 해야 할 것은 문제를 정의하는 것
- 회귀? 분류? 시계열? 비지도학습? 등등 다양한 접근 가능

### 3.1.2 솔루션

- 회귀문제를 멀티클래스분류문제로 바꾸는 등 다양한 접근법 존재

### 3.1.3 작동원리

- 회귀로 단순 수치가 아닌 분포를 모델링
  - output이 multimodal의 모습을 보이는 경우 유용하다.
- 목표변경: 같은 output으로 (output을 변환할 수도 있고) 다른 역할을 할 수 있는 모델을 만들 수 있다.

### 3.1.4 trade-off와 대안

- 버킷화된 출력: reframing의 대표적인 방법으로 output을 버킷화해서 multi-class 분류 문제로 접근한다.
- 불확실성을 포착하는 방법: 분위수회귀, 출력분포 추정
- 예측의 정밀도: output의 분포가 분산이 크면 분류문제로 바꿔서 접근하는 것이 효과적일 수 있으나 반대의 경우는 회귀가 훨씬 좋을 것이다.
- 예측 범위 제한하기: output의 특정 범위에만 나오는 경우라면 sigmoid층 이후 스케일링을 통해서 그 범위에 제한되는 예측을 하도록 만들 수 있다.
- 라벨 편향: 예를 들어, 추천시스템에서 어떤 라벨을 사용하느냐에 따라 결과가 달라질 것이다.
- 멀티태스크 학습: 회귀, 분류 둘 다 선택

## 3.2 디자인 패턴 6: multi-label

- 데이터 하나에 둘 이상의 label이 할당된 것

### 3.2.2 솔루션

- label을 멀티-핫 인코딩하고 각각 sigmoid 출력값으로 예측한다.

### 3.2.3 trade-off와 대안

- 각 label에 대한 sigmoid값에 대한 고려: label마다 threshold값이 다를 수 있다.
- 데이터셋 고려 사항: label간 계층이 있을 수도 있고 비율이 많이 다를 수도 있다.
- label이 겹치는 경우: 즉, 같은 의미를 갖고 있는데 다른 label로 취급받을 수 있다.

## 3.3 디자인 패턴 7: Ensemble

- 배깅, 부스팅, 스태킹

## 3.4 디자인 패턴 8: cascade

- cascade는 한 모델의 output이 다음 모델에 대한 input이 되거나 다음 모델의 선택을 결정하는 문제를 의미

### 3.4.3 trade-off와 대안

- 단일 모델: 단일 모델을 사용할 수 있으면 단일 모델을 사용하는 걸 권장한다.
- 희귀한 상황에서 회귀: 일부 값이 다른 값보다 훨씬 더 많은 데이터로 회귀를 진행할 떄 cascade가 유용하다.
  - 예를 들어, 위성 이미지에서 강우량 예측시 99% 픽셀에서는 비가 내리지 않는다. 이런 경우 각 픽셀마다 비가 올지 먼저 분류예측한 뒤에 비가 안오는 경우는 강우량을 0으로 놓고 회귀예측 모델을 만든다.

## 3.5 디자인 패턴 9: neutral class

- 확실히 구분되는 label이 아닌 경우 neutral class로 지정하여 분류하는 것이다. 라벨링이 필요하다.
- 예를 들어, 1~10점이 label로 있고 이를 1~5점은 low, 6~10점은 high라는 label로 분류모델을 만들었다. 이보다 4~6점은 medium이라는 neutral class를 추가하여 분류모델을 만들었을 때가 더 좋은 정확도를 가질 수 있다.

### 3.5.4 trade-off와 대안

- 전문가의 의견이 일지하지 않을 때: 이런 경우 neutral class를 사용하면 좋다.
- 고객 만족도: 만족도를 예측하는 경우에도 유용하다.
- 임베딩의 개선
- neutral class in reframing

## 3.6 디자인 패턴 10: rebalancing

### 3.6.2 솔루션

- 적절한 평가 지표
- 다운샘플링, 업샘플링
- 클래스 가중치

### 3.6.3 trade-off와 대안

- reframing, cascade
- 이상탐지
- 사용 가능한 minority class의 수: minority class의 절대적인 수에 따라 접근을 달리한다. 너무 적으면 다운샘플링을 적절하지 않을 수 있다.
- 서로 다른 기법의 결합: 예를 들어, 다운샘플링과 앙상블을 같이 하는 경우 등 다양한 기법을 같이 사용할 수 있다.
- 모델 아키텍처: 오픈소스의 모델들이 제공하는 기능을 이용하자.
- 설명 가능성의 중요성: 불균형 데이터를 처리할 떄 데이터에서 의미 있는 신호를 포착하는 것도 중요하다.
